{% comment %}
  Main Cart Section
{% endcomment %}

<div class="cart-page" style="padding: 3rem 0;">
  <div class="luxeline-container">
    <h1 class="luxury-heading" style="font-size: 3rem; margin-bottom: 2rem; color: var(--luxeline-black); text-align: center;">
      {{ 'cart.title' | t }}
    </h1>
    
    {% if cart.item_count > 0 %}
      <div style="display: grid; grid-template-columns: 1fr 400px; gap: 3rem; align-items: start;">
        {%- comment -%} Cart Items {%- endcomment -%}
        <div class="cart-items">
          {% for item in cart.items %}
            <div class="cart-item" style="display: grid; grid-template-columns: 120px 1fr auto; gap: 1.5rem; padding: 1.5rem 0; border-bottom: 1px solid var(--luxeline-border);">
              <a href="{{ item.url }}" style="display: block; border-radius: 0.5rem; overflow: hidden; background-color: var(--luxeline-muted);">
                {% if item.image %}
                  <img src="{{ item.image | image_url: width: 200 }}" alt="{{ item.title | escape }}" style="width: 100%; height: 120px; object-fit: cover;">
                {% else %}
                  <div style="width: 100%; height: 120px; background: linear-gradient(135deg, var(--luxeline-muted) 0%, #e8ddd5 100%);"></div>
                {% endif %}
              </a>
              
              <div>
                <h3 style="font-weight: 600; color: var(--luxeline-primary); margin-bottom: 0.5rem;">
                  <a href="{{ item.url }}">{{ item.product.title }}</a>
                </h3>
                
                {% unless item.product.has_only_default_variant %}
                  <p style="font-size: 0.875rem; color: rgba(114, 81, 60, 0.6); margin-bottom: 0.5rem;">
                    {{ item.variant.title }}
                  </p>
                {% endunless %}
                
                <p style="font-size: 1.125rem; font-weight: 600; color: var(--luxeline-primary); margin-bottom: 1rem;">
                  {{ item.final_price | money }}
                  {% if item.original_price > item.final_price %}
                    <span style="font-size: 0.875rem; color: rgba(114, 81, 60, 0.4); text-decoration: line-through; margin-left: 0.5rem;">
                      {{ item.original_price | money }}
                    </span>
                  {% endif %}
                </p>
                
                <div style="display: flex; align-items: center; gap: 1rem;">
                  <div style="display: flex; align-items: center; border: 2px solid rgba(114, 81, 60, 0.2); border-radius: 0.5rem; overflow: hidden;">
                    <button 
                      type="button"
                      data-cart-update
                      data-line="{{ forloop.index }}"
                      data-quantity="{{ item.quantity | minus: 1 }}"
                      style="width: 36px; height: 36px; border: none; background: white; color: var(--luxeline-primary); cursor: pointer; display: flex; align-items: center; justify-content: center;"
                      {% if item.quantity <= 1 %}disabled{% endif %}
                    >
                      {% render 'icon', icon: 'minus' %}
                    </button>
                    <span style="width: 48px; text-align: center; font-weight: 600; color: var(--luxeline-primary);">{{ item.quantity }}</span>
                    <button 
                      type="button"
                      data-cart-update
                      data-line="{{ forloop.index }}"
                      data-quantity="{{ item.quantity | plus: 1 }}"
                      style="width: 36px; height: 36px; border: none; background: white; color: var(--luxeline-primary); cursor: pointer; display: flex; align-items: center; justify-content: center;"
                    >
                      {% render 'icon', icon: 'plus' %}
                    </button>
                  </div>
                  
                  <button
                    type="button"
                    data-cart-remove
                    data-line="{{ forloop.index }}"
                    style="font-size: 0.875rem; color: rgba(114, 81, 60, 0.6); text-decoration: underline; background: none; border: none; cursor: pointer;"
                  >
                    {{ 'cart.remove' | t }}
                  </button>
                </div>
              </div>
              
              <div style="text-align: right;">
                <p style="font-size: 1.25rem; font-weight: 600; color: var(--luxeline-primary);">
                  {{ item.final_line_price | money }}
                </p>
              </div>
            </div>
          {% endfor %}
        </div>
        
        {%- comment -%} Cart Summary {%- endcomment -%}
        <div class="cart-summary" style="position: sticky; top: 6rem;">
          <div class="luxeline-card">
            <h2 class="luxury-heading" style="font-size: 1.5rem; margin-bottom: 1.5rem; color: var(--luxeline-black);">
              {{ 'cart.summary' | t }}
            </h2>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid var(--luxeline-border);">
              <span style="color: rgba(114, 81, 60, 0.7);">{{ 'cart.subtotal' | t }}</span>
              <span style="font-weight: 600; color: var(--luxeline-primary);">{{ cart.total_price | money }}</span>
            </div>
            
            {% if cart.total_price < 20000 %}
              <div style="padding: 1rem; background-color: rgba(232, 180, 188, 0.1); border-radius: 0.5rem; margin-bottom: 1.5rem; text-align: center;">
                <p style="font-size: 0.875rem; color: var(--luxeline-primary);">
                  {{ 'cart.free_shipping_progress' | t: remaining: 20000 | minus: cart.total_price | money }}
                </p>
              </div>
            {% else %}
              <div style="padding: 1rem; background-color: rgba(114, 81, 60, 0.1); border-radius: 0.5rem; margin-bottom: 1.5rem; text-align: center;">
                <p style="font-size: 0.875rem; color: var(--luxeline-primary); font-weight: 600;">
                  {% render 'icon', icon: 'check' %} {{ 'cart.free_shipping_eligible' | t }}
                </p>
              </div>
            {% endif %}
            
            <p style="font-size: 0.875rem; color: rgba(114, 81, 60, 0.6); margin-bottom: 1.5rem; text-align: center;">
              {{ 'cart.taxes_shipping' | t }}
            </p>
            
            <form action="/cart" method="post">
              <button type="submit" name="checkout" class="luxeline-button luxeline-button--primary luxeline-button--full luxeline-button--large">
                {{ 'cart.checkout' | t }}
              </button>
            </form>
            
            <a href="/collections/all" style="display: block; text-align: center; margin-top: 1rem; color: var(--luxeline-primary); text-decoration: underline;">
              {{ 'cart.continue_shopping' | t }}
            </a>
          </div>
          
          <div style="margin-top: 1.5rem; padding: 1rem; background-color: var(--luxeline-muted); border-radius: var(--luxeline-radius);">
            <div style="display: flex; align-items: center; gap: 0.75rem; margin-bottom: 0.75rem;">
              {% render 'icon', icon: 'shield' %}
              <span style="font-size: 0.875rem; color: var(--luxeline-primary);">{{ 'cart.secure_checkout' | t }}</span>
            </div>
            <div style="display: flex; align-items: center; gap: 0.75rem;">
              {% render 'icon', icon: 'truck' %}
              <span style="font-size: 0.875rem; color: var(--luxeline-primary);">{{ 'cart.free_shipping_over' | t }}</span>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      {%- comment -%} Empty Cart {%- endcomment -%}
      <div style="text-align: center; padding: 4rem 2rem;">
        <div style="width: 80px; height: 80px; margin: 0 auto 2rem; border-radius: 50%; background-color: var(--luxeline-muted); display: flex; align-items: center; justify-content: center; color: var(--luxeline-primary);">
          {% render 'icon', icon: 'cart' %}
        </div>
        <h2 class="luxury-heading" style="font-size: 2rem; margin-bottom: 1rem; color: var(--luxeline-black);">
          {{ 'cart.empty.title' | t }}
        </h2>
        <p style="color: rgba(114, 81, 60, 0.7); margin-bottom: 2rem;">
          {{ 'cart.empty.description' | t }}
        </p>
        <a href="/collections/all" class="luxeline-button luxeline-button--primary luxeline-button--large">
          {{ 'cart.empty.button' | t }}
        </a>
      </div>
    {% endif %}
  </div>
</div>

<style>
@media (max-width: 1024px) {
  .cart-page > .luxeline-container > div {
    grid-template-columns: 1fr !important;
  }
  
  .cart-summary {
    position: static !important;
  }
  
  .cart-item {
    grid-template-columns: 100px 1fr !important;
  }
  
  .cart-item > div:last-child {
    grid-column: 1 / -1;
    text-align: left !important;
    padding-top: 1rem;
  }
}
</style>

{% schema %}
{
  "name": "Cart",
  "settings": []
}
{% endschema %}
